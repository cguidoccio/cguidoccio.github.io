window.Demandbase=window.Demandbase||{},window.Demandbase.SiteOptimization={CLASS_CLOSED:"closed",CLASS_CLOSE_BUTTON:"recommended-block__close-button",CLASS_CLOSED_CONTENT:"recommended-block_closed__content",CLASS_HIDDEN:"_hidden",CLASS_LIST:"recommended-block__list",CLASS_LIST_ITEM:"recommended-block__list__recommended-item",CLASS_LIST_ITEM_TITLE:"recommended-block__list__recommended-item__title",CLASS_LOGO_WRAPPER:"recommended-block__logo-wrapper",CLASS_MAIN_BOTTOM:"BottomAlignedBlock",CLASS_MAIN_DEFAULT:"defaultBlock",CLASS_OPENED:"opened",CLASS_OPEN_CONTENT:"recommended-block_opened__content",CLASS_OPEN_TITLE:"recommended-block_open__title",CLASS_OPEN_TITLE_WRAPPER:"recommended-block_open__title-wrapper",CLASS_RIGHT_RAIL:"RightRail",CLASS_ROOT:"recommended-block",CLASS_SWITCHER_CONTROL:"recommended-block__slider__switchers",CLASS_SWITCHER_CONTROL_ITEM:"recommended-block__slider__switchers-item",CLASS_SWITCHER_CONTROL_WRAPPER:"recommended-block__slider__switchers-wrapper",CLASS_TITLE:"recommended-block__title",DIV:"div",SESSION_BLOCK_OPEN_STATE:"openedRecommendationBlock",DEFAULT_CONFIGURATION:{additionalClass:null,backgroundColorClass:null,closedTitle:"Recommended Content",companyProfile:null,cssFileURL:"https://tag.demandbase.com/shared/siteOptimization.css",delay:0,enabled:!1,fadeIn:0,fontColor:null,fontName:null,googleAnalyticsTrackerName:null,isGoogleAnalyticsEnabled:!1,isRippleAnimation:!0,isSwitchersDots:!0,isSwitchersArrows:!1,itemBackgroundColor:null,mainClass:"defaultBlock",openByDefault:!1,openTitle:null,recommendationApiURL:"https://site-optimization-api.company-target.com/recommend/",recommendationCompanyName:null,recommendationCompanyId:null,recommendationKey:null,recommendationsProtocol:"forceHTTPS",recommendationUrl:window.location.href,showCloseButton:!0,showCompanyName:!0,showFeedbackLink:!1,showIndicatorArrows:!0,showLogo:!0,showLogoWhenClosed:!0,showLogoWhenOpen:!1,showOnlyOnScroll:!1,showTitleWhenClosed:!0,showTitleWhenOpen:!0,switcherArrowsColor:"#444",state:{openedRecommendationBlock:null},widgetBackgroundColor:null,widgetContainerId:null},configuration:{},initialize:function(e){this.isAdmin=this.getQueryVariable("admin"),e&&Object.assign(this.configuration,this.DEFAULT_CONFIGURATION,e),this.insertStylesheet(),this.setGoogleAnalyticsObject(),this.configuration.companyProfile?this.setRecommendationsData(this.configuration.companyProfile):this.checkInitialData()},addAnimation:function(e){if(this.configuration.isRippleAnimation){var t=this,i=document.createElement(this.DIV);this.addClass(i,"animation-ripple-block"),e.appendChild(i);var n=setInterval(function(){if(document.querySelector("."+t.CLASS_ROOT)){var e=document.querySelector(".closed .animation-ripple-block");e&&t.addClass(e,"show-animation"),clearInterval(n)}},100)}},addClass:function(e,t){e.classList?e.classList.add(t):e.className+=" "+t},addFeedbackClickHandler:function(){var e=document.querySelector(".recommended-block__feedbacklink-wrapper");e&&Demandbase.Utilities.addEventListener(e,"click",this.feedbackLinkClickHandler.bind(this))},addSlidesControls:function(e){this.configuration.isSwitchersDots?(this.addClass(e,"recommended-block__slider-wrapper"),e.appendChild(this.buildSwitchersDots())):this.configuration.isSwitchersArrows&&(this.addClass(e,"recommended-block__slider-arrow-wrapper"),e.appendChild(this.buildSwitchersArrows()))},buildConversionPopup:function(e){var t="Decrease in Chance",i=" decrease_percent",n='<div class="recommendation-block__conversion-popup"><p class="recommendation-block__conversion-popup__title">Where is the AI taking me?</p><ul class="recommendation-block__conversion-popup__conversions">';if(void 0!==e.conversion_pages)for(var o=e.conversion_pages,s=0;s<o.length;s++){var a=o[s];void 0!==a.prob_increase_percentage&&null!==a.prob_increase_percentage&&void 0!==a.conversion_page&&null!==a.conversion_page&&(0<a.prob_increase_percentage&&(t="Increase in Chance",i=""),n+='<li class="recommendation-block__conversion-popup__conversion"><p class="recommendation-block__conversion-popup__conversion__percent-block'+i+'"><span class="recommendation-block__conversion-popup__arrow'+i+'"></span><span class="recommendation-block__conversion-popup__conversion__percent">'+a.prob_increase_percentage+"%</span>"+t+'</p><p class="recommendation-block__conversion-popup__conversion__increase-text">to get customer to:<span class="recommendation-block__conversion-popup__conversion__url">'+a.conversion_page+"</span></p></li>")}return n+="</ul></div>"},buildCloseButton:function(){var e=document.createElement(this.DIV);return e.innerHTML="X",this.addClass(e,this.CLASS_CLOSE_BUTTON),e},buildClosedTitle:function(){var e=document.createElement("p");return e.innerText=this.configuration.closedTitle.trim(),this.addClass(e,this.CLASS_TITLE),e},buildFeedbackLink:function(){var e=document.createElement(this.DIV);return this.addClass(e,"recommended-block__feedbacklink-wrapper"),this.addClass(e,"affect"),e.innerHTML='<p class="recommended-block___contentOfOpenedBlock__feedbackLink_link-text affect">Hey, I\'m not from '+this.configuration.recommendationCompanyName+'.</p><div class="recommended-block__feedbackLinkDiv__popup affect"><span class="recommended-block__feedbackLinkDiv__popup__tile">Enter your company name</span><input type="text" class="recommended-block__feedbackLinkDiv__popup__input" placeholder="Company name"></div>',e},buildOpenedTitle:function(){var e=document.createElement("p"),t=this.getOpenedTitle();return e.innerHTML=t,this.addClass(e,this.CLASS_OPEN_TITLE),e},buildOpenedTitleWrapper:function(e){var t=document.createElement(this.DIV);return e&&t.appendChild(this.buildOpenedTitle()),this.addClass(t,this.CLASS_OPEN_TITLE_WRAPPER),t},buildSlidesList:function(){var e=document.createElement(this.DIV),t=document.createElement("ul");return this.addClass(t,this.CLASS_LIST),e.appendChild(t),this.addSlidesControls(e),e},buildSwitchersArrows:function(){var e=document.createElement(this.DIV);return this.addClass(e,"recommendation-block__arrows-list"),e.innerHTML="",e},buildSwitchersDots:function(){var e=document.createElement(this.DIV);return this.addClass(e,this.CLASS_SWITCHER_CONTROL_WRAPPER),e.innerHTML='<ul class="'+this.CLASS_SWITCHER_CONTROL+'"></ul>',e},feedbackLinkClickCallback:function(){var e=document.querySelector(".recommended-block__feedbackLinkDiv__popup");this.toggleClass(e,"_opened_feedback")},feedbackLinkClickHandler:function(e){this.hasClass(e.target,"recommended-block__feedbackLinkDiv__popup__input")||this.feedbackLinkClickCallback()},feedbackResponseHandler:function(e){200<=e.status&&e.status<400&&this.feedbackSendCallback()},feedbackSendCallback:function(){var e=document.querySelector(".recommended-block__feedbackLinkDiv__popup");this.removeClass(e,"_opened_feedback"),document.querySelector(".recommended-block___contentOfOpenedBlock__feedbackLink_link-text").innerHTML="Thanks for the feedback!",document.querySelector(".recommended-block__feedbackLinkDiv__popup__input").value=""},findAncestor:function(e,t){for(;(e=e.parentElement)&&!e.classList.contains(t););return e},getIndicatorArrow:function(){return this.configuration.showIndicatorArrows?'<span class="link-indicator">â–¶</span>':""},getItemFromStorage:function(e){if(Demandbase.Utilities.isStorageEnabled("sessionStorage"))return window.sessionStorage.getItem(e);if(Demandbase.Utilities.isStorageEnabled("localStorage"))return window.localStorage.getItem(e);if(Demandbase.Utilities.isCookieEnabled())for(var t=document.cookie.split(";"),i=0;i<t.length;i++)if(-1!==t[i].indexOf(e))return t[i].split("=")[1];return this.configuration.state[e]},getOpenedTitle:function(){var e="",t="";return this.configuration.openTitle?e=this.configuration.openTitle.trim()+" ":(e="Recommendations for ",this.configuration.mainClass===this.CLASS_MAIN_DEFAULT&&(e="Here's what we recommend for ")),this.configuration.showCompanyName&&(t="<span class='company-name-wrapper'>"+this.configuration.recommendationCompanyName+"</span>"),e+t},hasClass:function(e,t){return e.classList?e.classList.contains(t):new RegExp("(^| )"+t+"( |$)","gi").test(e.className)},insertStylesheet:function(){var e=document.createElement("link");e.setAttribute("rel","stylesheet"),e.setAttribute("type","text/css"),e.setAttribute("href",this.configuration.cssFileURL),void 0!==e&&document.getElementsByTagName("head")[0].appendChild(e)},insertWidget:function(e){if(this.configuration.widgetContainerId)document.getElementById(this.configuration.widgetContainerId)&&document.getElementById(this.configuration.widgetContainerId).appendChild(e);else{var t=document.createElement(this.DIV);t.id="db-ai-personalization-container",t.appendChild(e),document.body.appendChild(t)}},sendGoogleAnalyticsEvent:function(e,t,i){if(this.configuration.isGoogleAnalyticsEnabled){var n=this.configuration.googleAnalyticsTrackerName?this.configuration.googleAnalyticsTrackerName+".send":"send";window.ga(n,{hitType:"event",eventCategory:e,eventAction:t,eventLabel:i,nonInteraction:!0,transport:"beacon"})}},setFontColor:function(e){var t=void 0!==e?e:this.configuration.fontColor,i=document.getElementsByClassName(this.CLASS_LIST_ITEM_TITLE);if(void 0!==i&&i.length)for(var n=0;n<i.length;n++)i[n].style.color=t;if(this.configuration.showTitleWhenOpen){var o=document.querySelector("."+this.CLASS_OPEN_TITLE_WRAPPER),s=document.querySelector("."+this.CLASS_OPEN_TITLE);s&&o&&(s.style.color=t,o.style.color=t)}if(this.configuration.showTitleWhenClosed){var a=document.querySelector("."+this.CLASS_TITLE);a&&(a.style.color=t)}},setFontFamily:function(e){var t=void 0!==e?e:this.configuration.fontName;document.getElementsByClassName(this.CLASS_ROOT)[0].style.fontFamily=t},setGoogleAnalyticsObject:function(){window.Demandbase.SiteOptimization.configuration.isGoogleAnalyticsEnabled&&void 0===window.ga&&(window.GoogleAnalyticsObject="ga",window.ga=window.ga||function(){(window.ga.q=window.ga.q||[]).push(arguments)},window.ga.l=+new Date)},setItemBackgroundColor:function(e){for(var t=void 0!==e?e:this.configuration.itemBackgroundColor,i=document.getElementsByClassName(this.CLASS_LIST_ITEM),n=0;n<i.length;n++)i[n].style.backgroundColor=t},setItemToStorage:function(e,t){Demandbase.Utilities.isStorageEnabled("sessionStorage")?sessionStorage.setItem(e,t):Demandbase.Utilities.isStorageEnabled("localStorage")?localStorage.setItem(e,t):Demandbase.Utilities.isCookieEnabled()?document.cookie=e+"="+t:this.configuration.state[e]=t},setStyles:function(){this.setFontColor(this.configuration.fontColor),this.configuration.mainClass===this.CLASS_MAIN_BOTTOM&&this.setItemBackgroundColor(this.configuration.itemBackgroundColor),this.setWidgetBackgroundColor(this.configuration.widgetBackgroundColor),this.setFontFamily(this.configuration.fontName)},setWidgetBackgroundColor:function(e){var t=void 0!==e?e:this.configuration.widgetBackgroundColor;document.getElementsByClassName(this.CLASS_ROOT)[0].style.backgroundColor=t},removeClass:function(e,t){e.classList?e.classList.remove(t):e.className=e.className.replace(new RegExp("(^|\\b)"+t.split(" ").join("|")+"(\\b|$)","gi")," ")},toggleClass:function(e,t,i){void 0===i&&(i=!this.hasClass(e,t)),i?this.addClass(e,t):this.removeClass(e,t)},alignListViewBlock:function(e){document.body.clientHeight!==window.innerHeight&&this.configuration.additionalClass===this.CLASS_RIGHT_RAIL&&this.addClass(e,"right-margined")},recommendationRequest:function(){new XMLHttpRequest;var e=this.configuration.recommendationUrl,t=this;this.getRecommendations(this.configuration.recommendationCompanyId,e,this.configuration.recommendationKey,function(e){e.recommendations&&void 0!==e.recommendations.length&&0<e.recommendations.length&&(t.overrideSid()&&(t.configuration.recommendationCompanyName=e.company_name),t.documentReady(e))})},buildContentOfClosedBlock:function(e){var t=[],i=document.createElement(this.DIV);this.addClass(i,this.CLASS_CLOSED_CONTENT),this.configuration.showTitleWhenClosed&&t.push(this.buildClosedTitle()),Array.prototype.forEach.call(t,function(e,t){i.appendChild(e)}),e.appendChild(i)},buildContentOfOpenedBlock:function(e){var t=[],i=document.createElement(this.DIV);this.addClass(i,this.CLASS_OPEN_CONTENT),this.configuration.showCloseButton&&t.push(this.buildCloseButton()),(this.configuration.showLogoWhenOpen||this.configuration.showTitleWhenOpen)&&t.push(this.buildOpenedTitleWrapper(this.configuration.showTitleWhenOpen)),t.push(this.buildSlidesList()),this.configuration.showFeedbackLink&&t.push(this.buildFeedbackLink()),Array.prototype.forEach.call(t,function(e,t){i.appendChild(e)}),e.appendChild(i)},addCustomStyles:function(e){var t=document.createElement("style");return this.configuration.customCSS&&(t.type="text/css",t.appendChild(document.createTextNode(this.configuration.customCSS)),e.appendChild(t)),t},setFadeInOnScroll:function(t){var e=this.configuration.delay?this.configuration.delay:0;0!==this.configuration.fadeIn&&-1!==this.configuration.fadeIn&&t.setAttribute("style","transition: opacity "+this.configuration.fadeIn/1e3+"s;");var i=this;this.configuration.showOnlyOnScroll?window.onscroll=function(){1!==t.style.opacity&&setTimeout(function(){t.style.opacity=1},e),i.onscroll(i,t)}:(setTimeout(function(){t.style.opacity=1},e),window.onscroll=function(e){i.onscroll(i,t)})},createWidgetWrapper:function(){var e=document.createElement(this.DIV);return this.addClass(e,this.CLASS_ROOT),this.configuration.mainClass===this.CLASS_RIGHT_RAIL||this.configuration.openByDefault||"true"===this.getItemFromStorage(this.SESSION_BLOCK_OPEN_STATE)?this.addClass(e,this.CLASS_OPENED):this.addClass(e,this.CLASS_CLOSED),e},addClassesForWidget:function(e){this.addClass(e,this.configuration.mainClass),this.configuration.additionalClass&&this.addClass(e,this.configuration.additionalClass),this.configuration.backgroundColorClass&&this.addClass(e,this.configuration.backgroundColorClass)},onTouchCallback:function(e,t,i,n,o){var s,a=this,r=function(){a.removeClass(c,a.CLASS_OPENED),a.addClass(c,a.CLASS_CLOSED),a.setItemToStorage(a.SESSION_BLOCK_OPEN_STATE,"false")},l=function(){a.removeClass(c,a.CLASS_CLOSED),a.addClass(c,a.CLASS_OPENED),a.setItemToStorage(a.SESSION_BLOCK_OPEN_STATE,"true")},c=document.querySelector("."+a.CLASS_ROOT),d=c.querySelectorAll("."+a.CLASS_LIST)[0],m=d.querySelectorAll("."+a.CLASS_LIST_ITEM),u=850<window.innerWidth?3:2,h=Math.ceil(m.length/u),_=d.parentNode.clientWidth;if("end"===i){var S=(_-m[0].clientWidth*u)/(2*u);if(s=-_*(h-1)+(m.length%u?(2*S+m[0].clientWidth)*(u-m.length%u):0),"right"==t&&0<parseInt(d.style.left)||"left"==t&&m.length<=u?d.style.left="0px":"left"==t&&Math.abs(parseInt(d.style.left))>-s&&(d.style.left=s+"px"),"right"!=t&&"left"!=t||(this.toggleClass(document.querySelector(".recommendation-block__arrows-list_common.left-arrow"),"_inactive",0===parseInt(d.style.left)),this.toggleClass(document.querySelector(".recommendation-block__arrows-list_common.right-arrow"),"_inactive",Math.abs(parseInt(d.style.left))===Math.floor(Math.abs(s)))),0,"none"===t)if(e.target.className!==a.CLASS_CLOSE_BUTTON){if(a.hasClass(c,a.CLASS_CLOSED))l();else if(this.configuration.mainClass===a.CLASS_MAIN_BOTTOM)if(a.hasClass(e.target,"affect")||!a.hasClass(e.target,"right-arrow")&&!a.hasClass(e.target,"left-arrow"))if(a.hasClass(e.target,"recommended-block_arrows-part")||a.hasClass(e.target,"round"))if(a.hasClass(e.target.offsetParent,"right-arrow"))c.querySelectorAll(".right-arrow .recommended-block_arrows-part")[0].click();else c.querySelectorAll(".left-arrow .recommended-block_arrows-part")[0].click();else a.hasClass(e.target.offsetParent,a.CLASS_LIST_ITEM)&&e.target.offsetParent.querySelectorAll("."+a.CLASS_LIST_ITEM_TITLE)[0].click();else r()}else a.hasClass(c,a.CLASS_OPENED)&&r();else"up"==t?a.hasClass(c,a.CLASS_CLOSED)&&l():"down"==t&&a.hasClass(c,a.CLASS_OPENED)&&r()}else"move"!=i||"right"!=t&&"left"!=t||(d.style.transition="left 1s",d.style.left=parseInt(d.style.left)+o+"px")},documentReady:function(e){var t=this.createWidgetWrapper();this.addCustomStyles(t),this.alignListViewBlock(t),this.addClassesForWidget(t),this.buildContentOfClosedBlock(t),this.buildContentOfOpenedBlock(t),this.addAnimation(t),this.insertWidget(t),this.sendGoogleAnalyticsEvent("AI personalization - Company Logo","impression","Company SID: "+this.configuration.recommendationCompanyId),this.setFadeInOnScroll(t),this.configuration.mainClass===this.CLASS_MAIN_BOTTOM&&this.ontouch(t,this.onTouchCallback.bind(this)),this.DOMmanipulations(e)},onscroll:function(e,t){window.innerHeight+window.scrollY>=document.body.scrollHeight?e.hasClass(t,e.CLASS_HIDDEN)||e.addClass(t,e.CLASS_HIDDEN):e.hasClass(t,e.CLASS_HIDDEN)&&e.removeClass(t,e.CLASS_HIDDEN)},ontouch:function(e,t){var i,n,o,s,a,r,l,c=e,d=t||function(e,t,i,n,o){};Demandbase.Utilities.addEventListener(c,"touchstart",function(e){var t=e.changedTouches[0];n=i="none",o=t.pageX,s=t.pageY,l=(new Date).getTime(),e.preventDefault()}),Demandbase.Utilities.addEventListener(c,"touchmove",function(e){var t=e.changedTouches[0];a=t.pageX-o,r=t.pageY-s,Math.abs(a)>Math.abs(r)?d(e,i=a<0?"left":"right","move",n,a):d(e,i=r<0?"up":"down","move",n,r),e.preventDefault()}),Demandbase.Utilities.addEventListener(c,"touchend",function(e){(new Date).getTime()-l<=500&&(150<=Math.abs(a)&&Math.abs(r)<=100?n=i:150<=Math.abs(r)&&Math.abs(a)<=100&&(n=i)),d(e,i,"end",n,"left"===i||"right"===i?a:r),e.preventDefault()})},onWidgetClick:function(t){var i=this;Demandbase.Utilities.addEventListener(t,"click",function(e){e.target.className!==i.CLASS_CLOSE_BUTTON&&(i.hasClass(t,i.CLASS_CLOSED)?(i.removeClass(t,i.CLASS_CLOSED),i.addClass(t,i.CLASS_OPENED),i.setItemToStorage(i.SESSION_BLOCK_OPEN_STATE,"true"),i.sendGoogleAnalyticsEvent("AI personalization - Company Logo","click: open block","Company SID: "+i.configuration.recommendationCompanyId)):i.configuration.mainClass===i.CLASS_MAIN_BOTTOM&&(i.hasClass(e.target,"affect")||i.hasClass(e.target.parentNode,"affect")||(i.removeClass(t,i.CLASS_OPENED),i.addClass(t,i.CLASS_CLOSED),i.setItemToStorage(i.SESSION_BLOCK_OPEN_STATE,"false"),i.sendGoogleAnalyticsEvent("AI personalization - Company Logo","click: open block","Company SID: "+i.configuration.recommendationCompanyId))))})},sendFeedback:function(e){var t=new XMLHttpRequest,i={served_sid:parseInt(this.configuration.recommendationCompanyId),corrected_company_name:e,url:window.location.href};t.open("POST","https://ai-personalization-prod-api.demandbase.com/feedback",!0),t.setRequestHeader("Content-type","application/json"),t.onload=this.feedbackResponseHandler.bind(this,t),t.send(JSON.stringify(i))},feedbackInputKeyupCallback:function(e){(void 0!==e.key&&"Enter"==e.key||void 0!==e.keyCode&&("Enter"==e.keyCode||13==e.keyCode))&&this.sendFeedback(e.target.value)},onFeedbackSend:function(){var e=document.querySelector(".recommended-block__feedbackLinkDiv__popup__input");e&&Demandbase.Utilities.addEventListener(e,"keyup",this.feedbackInputKeyupCallback.bind(this))},onCloseWidget:function(e,t){var i=document.querySelectorAll("."+e.CLASS_CLOSE_BUTTON)[0];i&&Demandbase.Utilities.addEventListener(i,"click",function(){e.hasClass(t,e.CLASS_OPENED)&&(e.removeClass(t,e.CLASS_OPENED),e.addClass(t,e.CLASS_CLOSED),e.setItemToStorage(e.SESSION_BLOCK_OPEN_STATE,"false"))})},buildItems:function(e,t){e.recommendations&&this.buildRecommendationsItems(t,e.recommendations,"."+this.CLASS_LIST)},buildLogo:function(e,t){if(e.logo&&this.configuration.showLogo){if(this.configuration.showLogoWhenClosed){var i=document.querySelectorAll("."+this.CLASS_TITLE)[0];this.addClass(document.querySelectorAll("."+this.CLASS_CLOSED_CONTENT)[0],"mrg-btm"),document.querySelectorAll("."+this.CLASS_CLOSED_CONTENT)[0].insertBefore(this.buildClosedLogo(e.logo),i)}if(this.configuration.showLogoWhenOpen){var n=document.querySelectorAll("."+this.CLASS_OPEN_TITLE)[0];document.querySelectorAll("."+this.CLASS_OPEN_TITLE_WRAPPER)[0].insertBefore(this.buildOpenedLogo(e.logo),n)}}},buildWidgetToggle:function(e){var t=e.querySelectorAll("."+this.CLASS_LIST+" ."+this.CLASS_LIST_ITEM);this.configuration.isSwitchersDots&&this.buildSwitcher(e,t.length),this.configuration.isSwitchersArrows&&this.buildArrows(e,t.length)},DOMmanipulations:function(e){var t=document.querySelectorAll("."+this.CLASS_ROOT)[0];this.onWidgetClick(t),this.addFeedbackClickHandler(this),this.onFeedbackSend(this),this.onCloseWidget(this,t),this.buildItems(e,t),this.buildLogo(e,t),this.buildWidgetToggle(t),this.setStyles()},ready:function(e){"loading"!==document.readyState?e.call(this):Demandbase.Utilities.addEventListener(document,"DOMContentLoaded",e.bind(this))},getRecommendations:function(e,t,i,n,o,s){var a=new XMLHttpRequest,r=window.btoa(t),l=(s||this.configuration.recommendationApiURL)+encodeURI(e)+"?page="+encodeURI(r)+"&apiKey="+encodeURI(i);a.open("GET",l,!0),a.withCredentials=!0,a.onload=function(){if(200<=a.status&&a.status<400){var e=JSON.parse(a.responseText);n&&n(e)}else o&&o()},a.onerror=function(){o()},a.send()},buildRecommendationsItems:function(e,t,i){var n=0!==e.querySelectorAll(i).length?e.querySelectorAll(i)[0]:e.querySelectorAll("."+this.CLASS_LIST)[0];n.innerHTML="";var o=6,s=3;this.configuration.additionalClass&&(s=o),t.length<6&&(o=t.length);for(var a="",r="",l=0;l<o;l++){this.configuration.mainClass!==this.CLASS_MAIN_BOTTOM&&s-1<l&&(r='style="display:none"'),0===l&&(r='style="left:0"'),a+='<li class="'+this.CLASS_LIST_ITEM+' affect"'+r+">",this.isAdmin&&(a+=this.buildConversionPopup(t[l]));var c="http://";"forceHTTPS"===this.configuration.recommendationsProtocol&&(c="https://");var d=t[l].title;d=d.length<=95?d:d.substring(0,95)+"...";var m=this.getIndicatorArrow();a+='<div class="recommended-block__list__recommended-item__image-wrapper"><div class="recommended-block__list__recommended-item__image-table-row-wrapper"><div class="recommended-block__list__recommended-item__image-table-cell-wrapper"><a onclick="window.Demandbase.SiteOptimization.itemOnClick(event)" href="'+c+t[l].page+'"><img src="'+t[l].image+'" alt="Preview" class="recommended-block__list__recommended-item__img"></div></div></a><a onclick="window.Demandbase.SiteOptimization.itemOnClick(event)" class="'+this.CLASS_LIST_ITEM_TITLE+'" href="'+c+t[l].page+'">'+d+m+"</a></div></li>"}n.innerHTML=a},itemOnClick:function(e){var t=this.findAncestor(e.target,this.CLASS_LIST_ITEM),i=document.querySelectorAll("."+this.CLASS_LIST)[0],n=Array.prototype.indexOf.call(i.children,t),o="";o=this.hasClass(e.target,"recommended-block__list__recommended-item__img")?e.target.parentNode.getAttribute("href"):e.target.getAttribute("href"),this.sendGoogleAnalyticsEvent("AI personalization - Content recommendation","click","Destination URL:"+o+" | Location of the asset:"+n)},buildSwitcher:function(e,t){var o=474;this.configuration.mainClass!==this.CLASS_MAIN_DEFAULT&&(o=297);var i=t%3==0?t/3:t/3+1,s=e.querySelectorAll("."+this.CLASS_LIST)[0];if(1<i){for(var n='<li class="'+this.CLASS_SWITCHER_CONTROL_ITEM+' _active"></li>',a='<li class="'+this.CLASS_SWITCHER_CONTROL_ITEM+'"></li>',r=document.querySelectorAll("."+this.CLASS_SWITCHER_CONTROL)[0],l="",c=i-1;0<c;c--)l+=a;r.innerHTML=n+l;var d=r.querySelectorAll("."+this.CLASS_SWITCHER_CONTROL_ITEM),m=this;Array.prototype.forEach.call(d,function(i,n){Demandbase.Utilities.addEventListener(i,"click",function(e){if(!m.hasClass(i,"_active")){Array.prototype.forEach.call(d,function(e,t){m.removeClass(e,"_active")}),m.addClass(i,"_active"),s.style.left=-1*o*n+"px";var t=s.querySelectorAll("."+m.CLASS_LIST_ITEM);Array.prototype.forEach.call(t,function(e,t){e.style.left=o*n+"px",Math.floor(t/3)===n?e.style.display="block":e.style.display="none"})}})})}},buildClosedLogo:function(e){var t=document.createElement(this.DIV);return this.addClass(t,this.CLASS_LOGO_WRAPPER),t.innerHTML='<img src="'+e+'" alt="Company Logo" class="recommended-block__logo-wrapper__logo">',t},buildOpenedLogo:function(e){var t=document.createElement(this.DIV);return this.addClass(t,this.CLASS_LOGO_WRAPPER),t.innerHTML='<img src="'+e+'" alt="Company Logo" class="recommended-block__logo-wrapper__logo">',t},buildArrows:function(e,t){var i=e.querySelectorAll(".recommendation-block__arrows-list")[0];if(3<=t){var n="";this.configuration.switcherArrowsColor&&(n='style="border-color: '+this.configuration.switcherArrowsColor+'"');var o="<div "+n+" class='recommended-block_arrows-part affect'></div>";i.innerHTML="<div class='recommendation-block__arrows-list_common left-arrow _inactive'><div class='recommended-block_arrows-part_round affect'></div>"+o+"</div><div class='recommendation-block__arrows-list_common right-arrow'><div class='recommended-block_arrows-part_round affect'></div>"+o+"</div>";var s=i.querySelector(".left-arrow .recommended-block_arrows-part"),a=i.querySelector(".right-arrow .recommended-block_arrows-part"),r=e.querySelectorAll("."+this.CLASS_LIST)[0],l=r.querySelectorAll("."+this.CLASS_LIST_ITEM);r.style.left="0";var c=this,d=function(){var e=l.length,t=850<window.innerWidth?3:2;return{sliderWrapperWidth:r.parentNode.clientWidth,numberOfSlidesInSection:t,sliderPosition:Math.abs(parseInt(r.style.left)),numberOfSections:Math.ceil(e/t)}};Demandbase.Utilities.addEventListener(s,"click",function(){var e=d();e.sliderPosition&&(r.style.left=e.sliderPosition/e.sliderWrapperWidth<1?"0px":-e.sliderWrapperWidth*(Math.ceil(e.sliderPosition/e.sliderWrapperWidth)-1)+"px"),m(r.style.left,e.sliderWrapperWidth,e.numberOfSections,!1)}),Demandbase.Utilities.addEventListener(a,"click",function(){var e=d(),t=!1;if(e.sliderPosition<e.sliderWrapperWidth*(e.numberOfSections-1)){var i=-e.sliderWrapperWidth*Math.floor(1+e.sliderPosition/e.sliderWrapperWidth),n=(e.sliderWrapperWidth-l[0].clientWidth*e.numberOfSlidesInSection)/(2*e.numberOfSlidesInSection);if(l.length%e.numberOfSlidesInSection&&Math.abs(i)===(e.numberOfSections-1)*e.sliderWrapperWidth)i+=(2*n+l[0].clientWidth)*(e.numberOfSlidesInSection-l.length%e.numberOfSlidesInSection),t=!0}r.style.left=i+"px",m(r.style.left,e.sliderWrapperWidth,e.numberOfSections,t)});var m=function(e,t,i,n){c.toggleClass(s.parentNode,"_inactive",0===Math.abs(parseInt(e))),c.toggleClass(a.parentNode,"_inactive",n||Math.abs(parseInt(e))===(i-1)*t)}}if(3===t)for(var u=document.querySelectorAll(".recommended-block_arrows-part"),h=0;h<u.length;h++)u[h].style.display="none";return i},overrideSid:function(){var e=this.getQueryVariable("sid");return e||null},applyOverrideSid:function(e){return e.demandbase_sid=this.overrideSid()?this.overrideSid():e.demandbase_sid,e},setRecommendationsData:function(e){e=this.applyOverrideSid(e),(this.configuration.companyProfile=e).demandbase_sid&&(this.configuration.recommendationCompanyId=e.demandbase_sid,this.configuration.recommendationCompanyName=e.marketing_alias,this.ready(this.recommendationRequest))},checkInitialData:function(){var t=new XMLHttpRequest,e="https://api.company-target.com/api/v2/ip.json?key="+encodeURI(this.configuration.recommendationKey);t.open("GET",e,!0);var i=this;t.onload=function(){if(200<=t.status&&t.status<400){var e=JSON.parse(t.responseText);i.setRecommendationsData(e)}},t.onerror=function(){},t.send()},getQueryVariable:function(e){for(var t=window.location.search.substring(1).split("&"),i=0;i<t.length;i++){var n=t[i].split("=");if(n[0]===e)return n[1]}}},void 0!==window.Demandbase.Config&&void 0!==window.Demandbase.Config.SiteOptimization&&void 0!==window.Demandbase.SiteOptimizationLoader&&Demandbase.ErrorReporter.wrap(function(){window.Demandbase.SiteOptimization.initialize(window.Demandbase.SiteOptimizationLoader.configuration)})();